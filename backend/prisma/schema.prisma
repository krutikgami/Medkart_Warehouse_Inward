generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}



model ProductMaster {
  id Int @id @default(autoincrement())
  product_code String @unique
  product_name String
  product_description String
  product_price Float
  product_mrp Float
  hsn_code Int
  product_last_purchase_price Float
  category String
  combination String[]
  unit_of_measure String
  status String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model VendorMaster{
  id          Int      @id @default(autoincrement())
  vendor_code  String @unique
  vendor_name  String
  contact_person String
  contact_number String
  gst_number  String
  vendor_email String
  address     String
  status      String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  purchaseOrders PurchaseOrder[]
}

model PurchaseOrder {
  id          Int      @id @default(autoincrement())
  vendor_code   String
  purchase_order_code String @unique
  purchase_date  DateTime
  total_amount Float
  expected_date DateTime
  status      String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  items       PurchaseOrderItem[] 
  vendorMaster VendorMaster @relation(fields: [vendor_code], references: [vendor_code])
  grn      Grn[]
}

model PurchaseOrderItem {
  id          Int      @id @default(autoincrement())
  purchase_order_code String 
  product_code  String
  quantity    Int
  mrp        Float
  cost_price  Float
  total_price Float
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  purchaseOrder PurchaseOrder @relation(fields: [purchase_order_code], references: [purchase_order_code])
}

model Grn {
  id          Int      @id @default(autoincrement())
  grn_code    String   @unique
  purchase_order_code String
  vendor_code   String
  grn_date    DateTime
  total_amount Float
  status      String
  total_damage_qty Int      @default(0)
  total_shortage_qty Int   @default(0)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  items       GrnItem[] 
  purchaseOrder PurchaseOrder @relation(fields: [purchase_order_code], references: [purchase_order_code])
}

model GrnItem {
  id          Int      @id @default(autoincrement())
  grn_code    String
  product_code String
  quantity    Int
  mrp        Float
  cost_price  Float
  total_price Float
  damage_qty Int      @default(0)
  shortage_qty Int   @default(0)
  batch_number String
  mfg_date   DateTime
  exp_date   DateTime
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  grn       Grn @relation(fields: [grn_code], references: [grn_code])
}

